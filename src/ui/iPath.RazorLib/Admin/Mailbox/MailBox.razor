@page "/admin/mailbox"

@inject MailBoxViewModel vm
@inject IStringLocalizer T

<IPathHeader Title=@T["Mailbox"]>
    <ActionContent>
        <MudFab StartIcon="@Icons.Material.TwoTone.Refresh"
                Size="Size.Small" IconSize="Size.Small"
                OnClick=@(() => vm.grid.ReloadServerData()) />
        <MudFab StartIcon="@Icons.Material.TwoTone.DeleteForever"
                Size="Size.Small" IconSize="Size.Small"
                OnClick="vm.DeleteAll" />
    </ActionContent>
</IPathHeader>

<MudDataGrid T="EmailMessage" ServerData="vm.GetData" @ref="vm.grid">
    <Columns>
        <HierarchyColumn T="EmailMessage" />
        <PropertyColumn Property="e => e.Receiver" Title=@T["Reveiver"] />
        <PropertyColumn Property="e => e.Subject" Title=@T["Subject"] />
        <PropertyColumn Property="e => e.CreatedOn" Format="d" Title=@T["Date"] />
        <TemplateColumn>
            <CellTemplate>
                <MudIconButton StartIcon="@Icons.Material.Filled.DeleteForever"
                        Size="Size.Small" OnClick=@(() => vm.Delete(context.Item)) />
            </CellTemplate>
        </TemplateColumn>
    </Columns>
    <ChildRowContent>
        @((MarkupString)context.Item.Body)
    </ChildRowContent>
    <PagerContent>
        <MudDataGridPager T="EmailMessage" />
    </PagerContent>
</MudDataGrid>

