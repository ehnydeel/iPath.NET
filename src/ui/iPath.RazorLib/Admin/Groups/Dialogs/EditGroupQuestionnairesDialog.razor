@namespace iPath.Blazor.Componenents.Admin.Groups


@using iPath.Blazor.Componenents.Admin.Questionnaires
@using iPath.Blazor.Componenents.Groups


<MudDialog Style="min-width: 700px;">
    <TitleContent>
        <MudText Typo="Typo.h6">
            <MudIcon Icon="@Icons.Material.Filled.Add" Class="mr-3 mb-n1" />
            Questionnaires for Group @Model.Name
        </MudText>
    </TitleContent>
    <DialogContent>
        <MudDataGrid Items="Items" Dense Striped>
            <ToolBarContent>
                <MudText Typo="Typo.h6">Questionnaires</MudText>
                <MudSpacer />
                <QuestionnaireLookup @bind-Value="selectedQ" @bind-Value:after="OnQuestionaireSelected" />
            </ToolBarContent>
            <Columns>
                <PropertyColumn Property="q => q.Name" Title="Id" />
                @foreach (var e in Usages)
                {
                    <TemplateColumn Title="@e.ToString()">
                        <CellTemplate>
                            <MudCheckBox @bind-Value="@context.Item.Usage[e]" 
                            @bind-Value:after="@(() => Save(context.Item, e))"/>
                        </CellTemplate>
                    </TemplateColumn>
                }
            </Columns>
        </MudDataGrid>
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="Cancel" Variant="Variant.Outlined">Close</MudButton>
        @if (saving)
        {
            <MudProgressCircular Indeterminate="true" Size="Size.Small" />
            <i>saving ...</i>
        }
        else if (!string.IsNullOrEmpty(ErrorMessage))
        {
            <MudTooltip Text="@ErrorMessage">
                <MudIcon Icon="@Icons.Material.Filled.Error" Size="Size.Small" Color="Color.Error" />
            </MudTooltip>
        }
    </DialogActions>
</MudDialog>


