@page "/admin/groups"

@attribute [Authorize(Roles = "Admin")]
@inject GroupAdminViewModel vm
@inject IStringLocalizer T

<IPathHeader Typo="Typo.h5" Title="Group Administration">
    <ActionContent>
        <MudTooltip Text=@T["create a new group"]>
            <MudFab StartIcon="@Icons.Material.Filled.Add" Size="Size.Small" OnClick="vm.Create" />
        </MudTooltip>
    </ActionContent>
</IPathHeader>

<MudTable T="GroupListDto" ServerData="vm.GetTableAsync" @ref="vm.table"
          RowStyleFunc="vm.SelectedRowStyle"
          Dense Class="ipath_table">
    <ToolBarContent>
        <MudText Typo="Typo.h6">Groups</MudText>
        <MudSpacer />
        <MudTextField @bind-Value="vm.SearchString" @bind-Value:after="@(() => vm.table.ReloadServerData())"
                      Placeholder="Search" Adornment="Adornment.Start"
                      AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"></MudTextField>
    </ToolBarContent>
    <HeaderContent>
        <MudTh>Group Name</MudTh>
    </HeaderContent>
    <RowTemplate>
        <MudTd Class="ipath_table">
            <MudLink Href=@($"admin/groups/{context.Id}")>@context.Name</MudLink>
        </MudTd>
        <MudTd Class="ipath_table d-flex justify-end">
            <MudIconButton Href=@($"admin/groups/{context.Id}/communities") Size="Size.Small"
                           Icon="@Icons.Material.Filled.Groups" />
            <MudIconButton Href=@($"admin/groups/{context.Id}/members") Size="Size.Small"
                           Icon="@Icons.Material.Filled.Person" />
            <MudIconButton Href=@($"admin/groups/{context.Id}/questionnaires") Size="Size.Small"
                           Icon="@Icons.Material.Filled.DynamicForm" />
        </MudTd>
    </RowTemplate>
    <PagerContent>
        <MudTablePager />
    </PagerContent>
</MudTable>

@code {
    int[] pageOpts => new[] { 25, 50, 100 };
}