@namespace iPath.Blazor.Componenents.Groups
@inject IStringLocalizer T

<MudForm Model="Model" Spacing="@Spacing">
    <MudTextField Label=@T["Purpose"] @bind-Value="Model.Purpose" Variant="@Variant"
                  Lines="4" AutoGrow="true" />

    <MudText Typo="Typo.h6" Class="mt-4">@T["Annotations"]</MudText>
    <MudSwitch Label=@T["Hide annotations"] @bind-Value="Model.AnnotationsHide" Color="Color.Info" />
    <MudSwitch Label=@T["Annotations with morphology code"] @bind-Value="Model.AnnotationHasMoprhoogy"  Color="Color.Info" />


    <MudText Typo="Typo.h6" Class="mt-4">@T["Case display"]</MudText>

    <MudSwitch Label=@T["Allow HTML in case description"] @bind-Value="Model.DescriptionAllowHtml"   Color="Color.Info" />

    <MudTextField Label=@T["Template for case description"] @bind-Value="Model.DescriptionTemplate"
                  Variant="@Variant" Lines="3" />

    <MudSwitch Label=@T["Case title active"] @bind-Value="Model.UseCaseTitleField" Color="Color.Info" Class="mt-4" />
    <MudSwitch Label=@T["Case sub-title active"] @bind-Value="Model.UseCaseSubTitleField" Color="Color.Info" />
    <MudSwitch Label=@T["Case type active"] @bind-Value="Model.UseCaseTypeField" Color="Color.Info" />


    <MudSwitch Label=@T["Body Site input active"] @bind-Value="Model.DescriptionWithBodySite" Color="Color.Info" Class="mt-4" />
    <MudSwitch Label=@T["Use grouped Body Site input"] @bind-Value="Model.DescriptionGroupedBodySiteInput" Color="Color.Info" />

    <MudTextField Label=@T["Case types"] @bind-Value="CaseTypeList" @bind-Value:after="ReadCaseTypes" Lines="8" Variant="@Variant" />
</MudForm>

@code {
    [Parameter]
    public GroupSettings Model { get; set; }

    [Parameter]
    public Variant Variant { get; set; } = Variant.Outlined;

    [Parameter]
    public int Spacing { get; set; }


    private string CaseTypeList = "";

    protected override void OnParametersSet()
    {
        CaseTypeList = string.Join(Environment.NewLine, Model.CaseTypes);
    }

    public void ReadCaseTypes()
    {
        Model.CaseTypes = CaseTypeList.Split("\n").Select(x => x.Trim()).ToList();
    }
}
