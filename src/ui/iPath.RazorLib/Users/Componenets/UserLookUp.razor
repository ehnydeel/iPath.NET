@inject UserViewModel vm

<MudAutocomplete T="UserListDto" @bind-Value="SelectedUser" @bind-Value:after="NotifyChange" @ref="me"
                 SearchFunc="vm.Search" MinCharacters="3"
                 ToStringFunc=@(e => e is null ? "" : $"{e.Username} [{e.Email}]")
				 ShowProgressIndicator="true"
                 Label="@Label" Variant="@Variant"
				 Class="@Class" Style="@Style"
				 Clearable="@Clearable" ReadOnly="@ReadOnly" Required="@Required" />

@code {
    [Parameter]
    public string? Label { get; set; }
    [Parameter]
    public string? Class { get; set; }
    [Parameter]
    public string? Style { get; set; }
    [Parameter]
    public Variant Variant { get; set; } = Variant.Outlined;
    [Parameter]
    public bool Clearable { get; set; } = true;
    [Parameter]
    public bool ReadOnly { get; set; } = false;
    [Parameter]
    public bool Required { get; set; } = false;

    [Parameter]
    public UserListDto? SelectedUser { get; set; }

    [Parameter]
    public EventCallback<UserListDto?> SelectedUserChanged { get; set; }


    MudAutocomplete<UserListDto> me;


    async Task NotifyChange()
    {
        await SelectedUserChanged.InvokeAsync(SelectedUser);
    }

    public async Task ClearAsync()
    {
        await me.ClearAsync();
    }
}
